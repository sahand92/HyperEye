function s = NIR2HSI(spectra)

% input NIR spectra (of size N X 1050)
% output are spectra of size (N X 267), in the HSI range
% note: 12 channels are discarded at the right edge to match NIR and HSI
% ranges, and 10 channels are discared from the left edge.

bands_HSI=[958.59,964.26,969.94,975.61,981.28,986.95,992.62,998.29,1003.95,1009.62,1015.29,1020.95,1026.61,1032.27,1037.93,1043.59,1049.25,1054.91,1060.57,1066.22,1071.88,1077.53,1083.18,1088.84,1094.49,1100.14,1105.79,1111.43,1117.08,1122.73,1128.37,1134.02,1139.66,1145.3,1150.94,1156.59,1162.23,1167.86,1173.5,1179.14,1184.78,1190.41,1196.05,1201.68,1207.31,1212.94,1218.57,1224.2,1229.83,1235.46,1241.09,1246.72,1252.34,1257.97,1263.59,1269.22,1274.84,1280.46,1286.08,1291.71,1297.33,1302.94,1308.56,1314.18,1319.8,1325.41,1331.03,1336.64,1342.26,1347.87,1353.48,1359.1,1364.71,1370.32,1375.93,1381.54,1387.15,1392.75,1398.36,1403.97,1409.57,1415.18,1420.78,1426.39,1431.99,1437.59,1443.2,1448.8,1454.4,1460,1465.6,1471.2,1476.8,1482.4,1487.99,1493.59,1499.19,1504.78,1510.38,1515.97,1521.57,1527.16,1532.76,1538.35,1543.94,1549.53,1555.12,1560.72,1566.31,1571.9,1577.49,1583.07,1588.66,1594.25,1599.84,1605.43,1611.01,1616.6,1622.18,1627.77,1633.36,1638.94,1644.52,1650.11,1655.69,1661.27,1666.86,1672.44,1678.02,1683.6,1689.18,1694.77,1700.35,1705.93,1711.51,1717.09,1722.67,1728.24,1733.82,1739.4,1744.98,1750.56,1756.14,1761.71,1767.29,1772.87,1778.44,1784.02,1789.6,1795.17,1800.75,1806.32,1811.9,1817.47,1823.05,1828.62,1834.19,1839.77,1845.34,1850.92,1856.49,1862.06,1867.64,1873.21,1878.78,1884.35,1889.93,1895.5,1901.07,1906.64,1912.22,1917.79,1923.36,1928.93,1934.5,1940.07,1945.65,1951.22,1956.79,1962.36,1967.93,1973.5,1979.07,1984.64,1990.21,1995.79,2001.36,2006.93,2012.5,2018.07,2023.64,2029.21,2034.78,2040.35,2045.92,2051.49,2057.06,2062.64,2068.21,2073.78,2079.35,2084.92,2090.49,2096.06,2101.63,2107.21,2112.78,2118.35,2123.92,2129.49,2135.06,2140.64,2146.21,2151.78,2157.35,2162.93,2168.5,2174.07,2179.64,2185.22,2190.79,2196.36,2201.94,2207.51,2213.09,2218.66,2224.24,2229.81,2235.38,2240.96,2246.54,2252.11,2257.69,2263.26,2268.84,2274.42,2279.99,2285.57,2291.15,2296.73,2302.3,2307.88,2313.46,2319.04,2324.62,2330.2,2335.78,2341.36,2346.94,2352.52,2358.1,2363.68,2369.26,2374.85,2380.43,2386.01,2391.6,2397.18,2402.76,2408.35,2413.93,2419.52,2425.1,2430.69,2436.28,2441.86,2447.45,2453.04,2458.63,2464.22,2469.81,2475.4,2480.99,2486.58,2492.17,2497.76,2503.35,2508.94,2514.54,2520.13,2525.73,2531.32,2536.92,2542.51,2548.11,2553.7,2559.3,2564.9];
bands_NIR=(400:2:2498);

bands_HSI_in_NIR = bands_HSI(1:end-12);

bands_NIR_fine=(400:0.01:2498);

idx = zeros(1,length(bands_HSI_in_NIR));
for i=1:length(bands_HSI_in_NIR)
    idx(i)=find(abs(bands_HSI_in_NIR(i)-bands_NIR_fine) < 0.001);  
end

% extrapolate NIR spectra to finer resolution
NIR_fine =  interp1(bands_NIR.',spectra.',bands_NIR_fine,'linear','extrap').';
s=NIR_fine(:,idx);

% finally the 1st 10 channels are discarded (detector edge)
s=s(:,10:end);
end